/**
 * extras.ts
 * Single source of truth for item extras, included ingredients, and varenr mapping.
 * Consolidates: itemExtras.ts + varenrMap.ts
 */

import extrasPerItem from '../../data/extras-per-item.json';

// Maps varenr (e.g. "1", "F14", "52C") to baseId used in extras-per-item.json
const varenrToBaseId: Record<string, string> = {"1":"10721","2":"10720","3":"10719","4":"10718","5":"10717","6":"10716","7":"10715","8":"10714","9":"10713","10":"10712","11":"10709","12":"10710","13":"10711","14":"10707","15":"10708","16":"10706","17":"10705","18":"10704","19":"10703","20":"10701","21":"10702","22":"10700","24":"10699","25":"10697","26":"10696","27":"10695","28":"10693","29":"10694","30":"10692","31":"10691","32":"10690","33":"10689","34":"10687","35":"10688","36":"10683","37":"10684","38":"10685","39":"10686","40":"10682","41":"10681","42":"10680","43":"10675","44":"10676","45":"10671","46":"10672","47":"10673","48":"10674","49":"10670","50":"10679","51":"10678","52":"10677","53":"10665","54":"10666","55":"10662","56":"10663","57":"10664","58":"14690","59":"14691","60":"14692","64":"10574","65":"10575","66":"10576","67":"10577","68":"10625","69":"10626","70":"10627","71":"10624","72":"10623","73":"10631","74":"10630","75":"10629","76":"10628","77":"14693","78":"10622","79":"10620","80":"10621","81":"10619","82":"10618","83":"10617","84":"10616","85":"10615","86":"10614","87":"10608","88":"14694","89":"10601","90":"10602","92":"10604","93":"10605","94":"10600","95":"10606","96":"10607","97":"10599","98":"10598","99":"10597","100":"10596","101":"10638","102":"10639","103":"10635","104":"10636","105":"10637","106":"10634","107":"10633","108":"10588","109":"10589","110":"10590","111":"10591","112":"10592","113":"10593","114":"10613","115":"10612","116":"10611","117":"10609","118":"10610","119":"10594","120":"10595","121":"43912","122":"43913","123":"43914","124":"43915","125":"43916","126":"43917","127":"43918","128":"43919","129":"43920","500":"10580","501":"10581","502":"10582","503":"10583","504":"10584","505":"10585","506":"10586","507":"10587","508":"17534","509":"43922","510":"43923","F14":"14683","F3":"14672","F6":"14675","F2":"14671","F15":"14684","F7":"14676","F13":"14682","F10":"14679","F4":"14673","F9":"14678","F8":"14677","F17":"14686","F11":"14680","F12":"14681","F5":"14674","F1":"14670","52C":"43911","52B":"43910","52A":"43909","107A":"10632"};

export type ExtraItem = { name: string; price: number };

export type ItemExtrasData = {
  included: string[];
  extras: ExtraItem[];
} | null;

const extrasData = extrasPerItem as Record<string, ItemExtrasData>;

/** Get extras data for a menu item by its varenr string ("Varenr. 1" or "1"). */
export function getItemExtras(varenr: string): ItemExtrasData {
  const cleanVarenr = varenr.replace(/^Varenr\.\s*/, '').trim();
  const baseId = varenrToBaseId[cleanVarenr];
  if (!baseId) return null;
  return extrasData[baseId] || null;
}

/** Returns true if an item has extras or removable included ingredients. */
export function hasExtras(varenr: string): boolean {
  const data = getItemExtras(varenr);
  return data !== null && (data.extras.length > 0 || data.included.length > 0);
}
